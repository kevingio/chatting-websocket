<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">


<!DOCTYPE html>
<html class=''>
<title>Kurir - Deliver your message in a second!</title>
<head
><script src='https://production-assets.codepen.io/assets/editor/live/console_runner-079c09a0e3b9ff743e39ee2d5637b9216b3545af0de366d4b9aad9dc87e26bfd.js'></script><script src='https://production-assets.codepen.io/assets/editor/live/events_runner-73716630c22bbc8cff4bd0f07b135f00a0bdc5d14629260c3ec49e5606f98fdd.js'></script><script src='https://production-assets.codepen.io/assets/editor/live/css_live_reload_init-2c0dc5167d60a5af3ee189d570b1835129687ea2a61bee3513dee3a50c115a77.js'></script><meta charset='UTF-8'><meta name="robots" content="noindex"><link rel="shortcut icon" type="image/x-icon" href="//production-assets.codepen.io/assets/favicon/favicon-8ea04875e70c4b0bb41da869e81236e54394d63638a1ef12fa558a4a835f1164.ico" /><link rel="mask-icon" type="" href="//production-assets.codepen.io/assets/favicon/logo-pin-f2d2b6d2c61838f7e76325261b7195c27224080bc099486ddd6dccb469b8e8e6.svg" color="#111" /><link rel="canonical" href="https://codepen.io/emilcarlsson/pen/ZOQZaV?limit=all&page=74&q=contact+" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,300' rel='stylesheet' type='text/css'>

<script src="https://use.typekit.net/hoy3lrg.js"></script>
<script>try{Typekit.load({ async: true });}catch(e){}</script>
<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css'>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns" crossorigin="anonymous">
<link rel="stylesheet" href="/assets/css/index.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
</head>
<body>

<div id="frame">
	<div id="sidepanel">
		<div id="profile">
			<div class="wrap">
				<img id="profile-img" src="https://emilcarlsson.se/assets/mikeross.png" class="online" alt="" />
				<p>{{ user.name }}</p>
                <a href="/logout"><i class="fas fa-power-off expand-button text-light" aria-hidden="true"></i></a>
			</div>
		</div>
		<div id="search">
			<label for=""><i class="fas fa-search" aria-hidden="true"></i></label>
			<input type="text" placeholder="Search persons..." />
		</div>
		<div class="contacts">
			<div v-if="loading">
				<div style="margin-top: 30px;" class="text-center">
					<i class="fas fa-spinner fa-spin"></i>
					<br><br>
					<small>Loading</small>
				</div>
			</div>
			<div v-else>
				<ul v-if="state === 'chat'">
					<div v-for="(chat, index) in chats">
						<li class="contact" v-bind:class="{ active: selected_room == index }">
							<div class="wrap" @click="activeChat(index, chat)">
								<span class="contact-status online"></span>
								<img src="https://emilcarlsson.se/assets/harveyspecter.png" alt="" />
								<div class="meta">
									<p class="name" v-if="chat.type == 'private'">{{ chat.name }}</p>
									<p class="name" v-else>{{ chat.room_name }}</p>
									<p class="preview">Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things.</p>
								</div>
							</div>
						</li>
					</div>
				</ul>
				<ul v-else>
					<div v-for="(user, index) in online_users">
						<li class="contact" v-bind:class="{ active: selected_room == index }">
							<div class="wrap" @click="activeChat(index, user)">
								<span class="contact-status online"></span>
								<img src="https://emilcarlsson.se/assets/harveyspecter.png" alt="" />
								<div class="meta">
									<p class="name">{{ user.name }}</p>
									<p class="preview">Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things.</p>
								</div>
							</div>
						</li>
					</div>
				</ul>
			</div>
		</div>
		<div id="bottom-bar">
			<button id="btn-group" @click="changeState('chat')" class="btn-tab active">
				<i class="fas fa-refresh fa-fw" aria-hidden="true"></i>
				<span>Recent Chat ({{ total_chat }})</span>
			</button>
			<button id="btn-user-online" @click="changeState('online')" class="btn-tab">
				<i class="fas fa-smile fa-fw" aria-hidden="true"></i>
				<span>Online ({{ total_user }})</span>
			</button>
		</div>
	</div>
	<div class="content">
		<div v-if="!activeRoom">
			<div class="container h-100">
				<div class="row h-100 justify-content-md-center align-items-center">
					<div class="col-auto text-center">
						<h1 style="font-size: 2rem;" class="font-weight-bold animated pulse infinite">Kurir</h1>
						<h2 style="font-size: 1.2rem;">Deliver your message in a second</h2>
					</div>
				</div>
			</div>
		</div>
		<div v-else>
			<div class="contact-profile">
				<img src="https://emilcarlsson.se/assets/harveyspecter.png" alt="" />
				<p v-if="activeRoom.type == 'private'">{{ activeRoom.name }}</p>
				<p v-else>{{ activeRoom.room_name }}</p>
				<div class="social-media">
	                <a href="whatsapp://send?text=Yuk kita chatting di sini guys!"><i class="fab fa-whatsapp" aria-hidden="true"></i></a>
	                <a href="line://msg/text/?Yuk kita chatting di sini guys!"><i class="fab fa-line" aria-hidden="true"></i></a>
	                <a href="https://www.facebook.com/sharer/sharer.php?u=kongko.id"><i class="fab fa-facebook" aria-hidden="true"></i></a>
				</div>
			</div>
			<div class="messages">
				<ul>
					<div v-for="chat in activeChatMessage">
						<li v-if="chat.user_id == user.id" class="sent">
							<img src="https://emilcarlsson.se/assets/mikeross.png" alt="" />
							<p>{{ chat.message }}</p>
						</li>
						<li v-else class="replies">
							<img src="https://emilcarlsson.se/assets/harveyspecter.png" alt="" />
							<p>{{ chat.message }}</p>
						</li>
					</div>
				</ul>
			</div>
			<div class="message-input">
				<div class="wrap">
				<input type="text" placeholder="Write your message..." />
				<i class="fa fa-paperclip attachment" aria-hidden="true"></i>
				<button class="submit"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
				</div>
			</div>
		</div>
	</div>
</div>
<script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js'></script>
<script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js" charset="utf-8"></script>
<script type="text/javascript">
	var halo = new Vue({
		el: '#frame',
		data: {
			chats: [],
			total_chat: 0,
			loading: true,
			total_user: 0,
			online_users: [],
			selected_room: null,
			state: 'chat',
			activeRoom: null,
			activeChatMessage: [],
			user: {
				name: 'Kurir'
			},
		},
		created () {
			this.initChats();
		},
		methods: {
			initChats() {
				let vm = this;
				axios.get('/getLoggedInUser')
				.then(function (response) {
					vm.user = response.data;
				});
				axios.get('/getOnlineUsers')
				.then(function (response) {
					vm.total_user = response.data.total
					vm.online_users = response.data.users
				});
				axios.get('/getRecentRoomChats')
				.then(function (response) {
					vm.chats = response.data.chats;
					vm.total_chat = response.data.total;
					sleep(1000);
					vm.loading = false;
				});
			},
			changeState(type) {
				this.selected_room = null;
				this.activeRoom = null;
				this.state = type;
				console.log(type);
			},
			activeChat(item, user) {
				let vm = this;
				vm.selected_room = item;
				vm.activeRoom = user;
				console.log(vm.activeRoom);

				axios.get('/getChatMessage?room_id=' + vm.activeRoom.room_id)
				.then(function (response) {
					vm.activeChatMessage = response.data;
				});
			}
			sleep(milliseconds) {
				var start = new Date().getTime();
				for (var i = 0; i < 1e7; i++) {
					if ((new Date().getTime() - start) > milliseconds){
					  	break;
					}
				}
			}
		}
	});
</script>
<script>

// var socket = io.connect();
//
// // let's assume that the client page, once rendered, knows what room it wants to join
// var room = "abc123";
//
// socket.on('connect', function() {
//    // Connected, let's sign-up for to receive messages for this room
//    socket.emit('room', room);
// });
//
// socket.on('message', function(data) {
//    // console.log('Incoming message:', data);
//    // console.log('janck');
// });

$('.btn-tab').on('click', function () {
    $('.btn-tab').removeClass('active');
    $(this).addClass('active');
});

$('.contact').on('click', function () {
    $('.contact').removeClass('active');
    $(this).addClass('active');
});

$(".messages").animate({ scrollTop: $(document).height() }, "fast");

function newMessage() {
	message = $(".message-input input").val();
	if($.trim(message) == '') {
		return false;
	}
	$('<li class="sent"><img src="https://emilcarlsson.se/assets/mikeross.png" alt="" /><p>' + message + '</p></li>').appendTo($('.messages ul'));
	$('.message-input input').val(null);
	$('.contact.active .preview').html('<span>You: </span>' + message);
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
};

$('.submit').click(function() {
  newMessage();
});

$(window).on('keydown', function(e) {
  if (e.which == 13) {
    newMessage();
    return false;
  }
});

// chatting

</script>
</body></html>
